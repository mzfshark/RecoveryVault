<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/>
    <meta name="description" content="Recovery Vault — Fixed redemption UI for pre-hack wallets on Harmony." />
    <meta name="theme-color" content="#0F172A" />
    <meta name="color-scheme" content="light dark" />
    <link rel="icon" href="/favicon.ico" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <script>
      (function () {
        try {
          const saved = localStorage.getItem('theme');
          const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
          const isDark = saved ? saved === 'dark' : prefersDark;
          document.documentElement.classList.toggle('dark', isDark);
        } catch (e) {}
      })();
    </script>
    <title>Recovery Vault</title>
  </head>
  <body>
    <script>
    (function () {
      function showOverlay(msg) {
        var el = document.getElementById('__panic_overlay__');
        if (!el) {
          el = document.createElement('div');
          el.id = '__panic_overlay__';
          el.style.cssText = 'position:fixed;inset:0;background:rgba(0,0,0,.85);color:#fff;z-index:999999;padding:16px;overflow:auto;font:14px/1.4 ui-monospace,Menlo,monospace';
          document.body.appendChild(el);
        }
        var p = document.createElement('pre');
        p.textContent = '[Crash] ' + new Date().toISOString() + '\n' + msg + '\n';
        el.appendChild(p);
      }

      window.addEventListener('error', function (e) {
        var m = (e && (e.message || e.error && e.error.stack)) || String(e);
        showOverlay(m);
      });
      window.addEventListener('unhandledrejection', function (e) {
        var r = e && e.reason;
        var m = (r && (r.stack || r.message)) || JSON.stringify(r);
        showOverlay('Unhandled Rejection: ' + m);
      });

      // Diagnóstico rápido de ambiente
      if (typeof BigInt === 'undefined') {
        showOverlay('Este navegador NÃO suporta BigInt. iOS < 14/Safari antigo causam tela branca.');
      }
      if (!('crypto' in globalThis && crypto.getRandomValues)) {
        showOverlay('crypto.getRandomValues ausente — alguns módulos (ethers) podem falhar.');
      }
    })();
    </script>

    <noscript>Enable JavaScript to use this application.</noscript>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>
